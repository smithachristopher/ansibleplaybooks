---

- name: Setup
  hosts: server_node1
  remote_user: root
  tasks:
    # 1. check if 1pv6 is enabled ifconfig |grep inet6
    # 2. edit vi /etc/sysctl.conf and append
    # net.ipv6.conf.all.disable_ipv6 = 1
    # net.ipv6.conf.default.disable_ipv6 = 1
    # 3.apply changes sysctl -p
    # 4 . check if 1pv6 is enabled ifconfig |grep inet6
      - name: Disable IPv6 with sysctl
        sysctl: name={{ item }}
                value=1
                state=present
                reload=yes
        with_items:
          - net.ipv6.conf.all.disable_ipv6
          - net.ipv6.conf.default.disable_ipv6
          - net.ipv6.conf.lo.disable_ipv6
# 1. check updates - sudo yum check-update
# 2. refresh package and install update - sudo yum update
# 3. reboot system - sudo reboot

      - name: update the packages
        yum:
          state: latest
          update_cache: yes  # Force yum to check if cache is out of date and redownload if needed.
          update_only: yes   # When using latest, only update installed packages.
          reboot: yes
          #   when: ansible_os_family == 'centos'

      - name: reboot Systems
        sysctl:
          reload: yes
# Connect to the server via SSH as the root user; or open a terminal if youâ€™re working locally.
# Install the EPEL repository with the following command: sudo yum install epel-release
# Confirm your work and refresh the repo list by running: sudo yum repolist
      - name: install epel-release
        yum:
          name: epel-release
          state: latest
          when: ansible_facts['os_family'] == 'centos'

      - name: refresh the repo list
        yum:
          name: repolist
          state: restarted
# For remote CentOS 8 server login using ssh command.
# Turn on EPEL repo
# Execute sudo yum search htop command to search for htop on CentOS
# Run sudo yum install htop to install htop in CentOS 8
# Update sudo yum update htop to upgrade htop to the latest version in CentOS 8

      - name: install htop on centos
        yum:
          name: htop
          state: installed
          when: ansible_facts['os_family'] == 'centos'

      - name: enable htop
        yum:
          name: htop
          state: started
